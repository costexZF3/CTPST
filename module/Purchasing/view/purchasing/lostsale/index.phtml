<?php     
    /*getting values */
       
    $this->headTitle('Lost Sales: Quoted Items no Stock no Order');	
    $this->mainMenu()->setActiveItemId('lostsales'); 
   
    $this->pageBreadcrumbs()->setItems([
        'Home'=>$this->url('home'),
        'Lost Sales'=>$this->url('lostsales')       
        ]);       
    
    //*** getting params from IndexAction() inside LostsaleController 
    $user = $this->user;
    $specialAccess = $this->specialAccess;
    $lostSales = $this->lostsalelist;    
    $tableHeader = $this->tableHeader;
 ?>  
 	 
<script language="JavaScript">      
                  
   
        
    const getTimesQuote =( tq )=> {
        let color = "";
        var NodeList = [];
        
        switch (tq ){
            case 'tq100plus' :                 
                hideElement('tq50plus'); hideElement('tq30plus'); hideElement('tq10plus'); hideElement('tq5plus');                
                
                color = "#E6CAE6";
                
                //hide all items with class under tq50plus
                showElement('tq100plus'); 
                
                /* changing color to Elements for being redered */
                NodeList['tq100plus'] = queryAllElement('.tq100plus');
                NodeList['tq100plus'].forEach(item=>{ changeBGColor(item, color);});                
            break;
            
            case 'tq50plus' :                 
                //hide all items with class under tq50plus
                hideElement('tq30plus'); hideElement('tq10plus'); hideElement('tq5plus');
                
                color = "#ffff80"; 
                
                //Show elements with classes: tq100plus and tq50plus                
                showElement('tq100plus'); showElement('tq50plus'); 
                
                NodeList['tq50plus'] = queryAllElement('.tq50plus');
                
                //change background color                
                 NodeList['tq50plus'].forEach(item=>{ changeBGColor(item, color);});
                 NodeList['tq100plus'].forEach(item=>{ changeBGColor(item, color);});                  
            break;
            
            case 'tq30plus' :
                
                //hide all items with class under tq30plus                
                hideElement('tq10plus'); hideElement('tq5plus');
                
                /* background color for elements with class: tq30plus*/
                color = "#CDCD6E";                 
                
                showElement('tq100plus'); showElement('tq50plus'); showElement('tq30plus'); 
                
                NodeList['tq30plus'] = queryAllElement('.tq30plus');
                
                //change background color                
                NodeList['tq30plus'].forEach(item=>{ changeBGColor(item, color);});
                NodeList['tq50plus'].forEach(item=>{ changeBGColor(item, color);});
                NodeList['tq100plus'].forEach(item=>{ changeBGColor(item, color);});
            break;
            
            case 'tq10plus': 
                //hide all items with class under tq10plus                
                hideElement('tq5plus');
                
                /* background color for elements with class: tq10plus*/
                color = "#CAE6E6";                 
                
                /* rendering elements */
                showElement('tq100plus'); showElement('tq50plus'); showElement('tq30plus'); showElement('tq10plus'); 
                
                NodeList['tq10plus'] = queryAllElement('.tq10plus');
                
                //change background color                
                 NodeList['tq10plus'].forEach(item =>{ changeBGColor(item, color);});
                 NodeList['tq30plus'].forEach(item =>{ changeBGColor(item, color);});
                 NodeList['tq50plus'].forEach(item =>{ changeBGColor(item, color);});
                 NodeList['tq100plus'].forEach(item =>{ changeBGColor(item, color);});
            break;
                
            default:
                color = "#dfff80";
            break;
        }; /* end case */                    
    };  
        
    /**
     * @param {string} timesQ  : (it could have the following values: tq100plus, tq50plus, tq30plus, tq10plus)
     * @returns {undefined}
     */
    const timesQuote = (timesQ) =>{ getTimesQuote( timesQ );}; 

   /* getting all parts from screen */
    const fillArray_partsLostSales = ()=> {
            
    };

    /*
     * JQuery code:
     * This occurs when the page has finished to load
    */    
    
    $(document).ready( function(){ 
           //------------------ function to convert to EXCEL FILE THE LOGGED CONTENT TO SCREEN ---------------------------------------- 
        $("#convert").click( function() {
            convertToExcel('LostSales','lost sales');
        });
         
        /* hidding all Elements with less than 100 times quotes*/ 
//        hideElement('tq50plus');
//        hideElement('tq30plus');
//        hideElement('tq10plus');
//        hideElement('tq5plus');
        filterTable('table_filter');
        //$('.table_filter').dataTable();
        /* call a function which it  fills an array with items rendered on the screen */
         //const LostSales = fillArray_partsLostSales();
        }); 

</script>
        
<!-- HTML RENDER-->

<!-- **************************************** FLASH MESSENGER RENDER ***************************************************--> 
<?= $this->flashMessenger()->render('error', ['alert', 'alert-warning']); ?>
<?= $this->flashMessenger()->render('success', ['alert', 'alert-success']); ?>
<?= $this->flashMessenger()->render('info', ['alert', 'alert-info']); ?>

<?php if ($specialAccess): ?>
    <div class="ctp_title"> 
       <h1> Quoted Items no Stock no Order ( LostSales ) </h1>
    </div>   
   <div class ="ctp-panel">
       <div class="ctp-panel-header">
            <h3 class="ctp_subtitle"> Tuning your Choice </h3>
       </div>     
        <div class = "row ctp-panel-body">          
            <div class="col-md-2">                   
                <p> Times Quotes[10+, 30+, 50+, 100+]: </p>
                <form>
                    <div class="alert alert-warning">                        
                        <input onclick="timesQuote('tq10plus')" type="radio" name="timesquote" id="tqr10" required >
                        <label for="tqr10"><span> 10+ </span></label>

                        <input onclick="timesQuote('tq30plus')" type="radio" name="timesquote" id="tqr30" required>
                        <label for="tqr30"><span> 30+ </span></label>

                        <input onclick="timesQuote('tq50plus')" type="radio" name="timesquote" id="tqr50" required>
                        <label for="tqr50"><span> 50+ </span></label>

                        <input onclick="timesQuote('tq100plus')"type="radio" name="timesquote" id="tqr100" required>
                        <label for="tqr100"><span> 100+ </span></label>
                    </div>                
                </form>
            </div>            
        </div>
       <div class="row">
            <div class="col-sm-offset-4 col-sm-8">
                <input class="btn btn-info" id="convert" type="button" name="btnexcel" value="Convert to Excel">
                <input class="btn btn-danger" id="topdf" type="button" name="btnpdf" value="Convert to PDF">
                <input class="btn btn-success" id="towishlist" type="button" name="towishlist" value="Save to Wish List">
            </div>
        </div>
       <br>
   </div>
   <?=$tableHeader;?>
<?php endif; ?>


       

